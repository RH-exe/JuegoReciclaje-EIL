<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SelecciÃ³n de Ãrea</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden; /* fuerza que nunca aparezca scroll */
  }
</style>
</head>
<body class="bg-gray-100">

  <!-- HEADER -->
  <header class="bg-white border-b-8 border-lime-500 flex items-center ">
    <img src="sources/imagess/logo-eil.png" alt="EIL" class="h-20 w-auto px-10 py-2 my-2 ">
  </header>

<main class="w-full bg-[url('sources/imagess/fondo.jpg')] bg-center bg-cover flex items-center justify-center overflow-hidden" style="height: calc(100vh - 96px); ">
  <!-- Caja de contenido -->
  <div class="bg-white/60 rounded-2xl shadow-lg p-8 w-[90%] max-w-6xl">
    <h2 class="text-xl font-bold text-gray-800 mb-6 text-center uppercase">
      Seleccione el Ã¡rea que pertenezca
    </h2>

    <!-- GRID DE BOTONES -->
    <div id="contenedor" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 text-center">
    </div>
  </div>
</main>
  <!-- SCRIPT -->
  <script>
    const areas = [
      {nombre : "DesorciÃ³n", nombreArea: "DESORCION", color:"bg-blue-900 text-white",  puntaje : 0},
      {nombre : "T.I", nombreArea: "T.I", color:"bg-lime-500 text-black",  puntaje : 0},
      {nombre : "FundiciÃ³n y refinaciÃ³n", nombreArea: "FUNDICION Y REFINACION", color:"bg-blue-900 text-white",  puntaje : 0},
      {nombre : "AdministraciÃ³n", nombreArea: "ADMINISTRACION", color:"bg-lime-500 text-black",  puntaje : 0},
      {nombre : "Laboratorio quimico", nombreArea: "LABORATORIO QUIMICO", color:"bg-blue-900 text-white",  puntaje : 0},
      {nombre : "Laboratorio metalurgico", nombreArea: "LABORATORIO METALURGICO", color:"bg-lime-500 text-black",  puntaje : 0},
      {nombre : "Mantenimiento", nombreArea: "MANTENIMIENTO", color:"bg-blue-900 text-white",  puntaje : 0},
      {nombre : "Ssoma", nombreArea: "SSOMA", color:"bg-lime-500 text-black",  puntaje : 0},
      {nombre : "Almacen", nombreArea: "ALMACEN", color:"bg-blue-900 text-white",  puntaje : 0} 
    ];
    const params = new URLSearchParams(window.location.search);
    const areaUsuario = params.get("area");
    console.log("AREA desde LA URL", areaUsuario);
    const contenedor = document.getElementById("contenedor");

    function blockArea (){
      contenedor.innerHTML = "";
      areas.forEach(area =>{          
        const button = document.createElement("button");
        button.className = `w-full h-16 cursor-pointer rounded-xl font-semibold text-xl shadow-md hover:scale-105 transition-transform flex flex-col justify-center ${area.color}`;
        button.onclick = () => inicio(area.nombre);

        const nombre = document.createElement("span");
        nombre.textContent = area.nombre;

        const puntaje = document.createElement("span");
        puntaje.textContent = `Puntaje: ${area.puntaje ?? 0}`;
        puntaje.className= 'text-red-600  text-xs'

        button.appendChild(nombre);
        button.appendChild(puntaje);
        if (area.nombreArea === areaUsuario) {
          button.classList.add("hover:scale-105", "cursor-pointer");
          button.onclick = () => inicio(area.nombre);
        } else {
          button.disabled = true;
          button.classList.add("opacity-50", "cursor-not-allowed");
        }
        contenedor.appendChild(button);
      })
    };

    async function cargarPuntaje() {
      try{
        const res = await fetch("sources/php/puntajeArea.php");
        if (!res.ok) throw new Error(`Error HTTP: ${res.status}`);
        const data = await res.json();

        console.log("Datos recibidos:", data);

        areas.forEach(area =>{
            area.puntaje = data[area.nombre];
        });

        blockArea();
      }catch(err){
        console.error("error al cargar el puntaje", err);
        blockArea();
      }
    }

    function inicio(valor){
      window.location.href="pages/inicio.html?userarea=" + encodeURIComponent(valor);
    }
    cargarPuntaje();

    window.addEventListener('load', ()=>{  
     
        Swal.fire({toast: true, position: 'center', 
        html: `
        <div style="text-align: left; font-size: 20px; line-height: 1.6; max-height: 400px; overflow-y: auto; padding-right: 10px;">
          <p style="text-align: center"; font-size: 30px ><b>Reglas Oficiales del DesafÃ­o: "MisiÃ³n Reciclaje"</b><p/>
          <hr style="margin: 10px 0;">
          <p><b>â€œPiensa, actÃºa y segregaâ€</b></p>
          <p>â€œCambia tus hÃ¡bitos, cambia el mundo.â€</p>
          <p>â€œHaz la diferencia, segrega tus residuos.â€</p>
          <p>â€œDesafÃ­o ecolÃ³gico: Â¿reciclas o contaminas?â€</p>
          <p>â€œEl futuro se recicla hoy.â€</p>
          <p>â€œÂ¡Acepta el reto y salva el planeta!â€</p>
          <p>â€œCada residuo tiene su lugar.â€</p>
          <hr style="margin: 10px 0;">
          <p><b>ğŸ¯ Objetivo:</b> Fomentar el conocimiento sobre <b>GESTIÃ“N DE RESIDUOS SÃ“LIDOS</b> y la correcta <b>SEGREGACIÃ“N</b> de residuos de una manera divertida y colaborativa, promoviendo el trabajo en equipo y nuestro compromiso con la sostenibilidad.</p>
          <hr style="margin: 10px 0;">
          <p><b>ğŸ“… Fechas y DuraciÃ³n:</b> El desafÃ­o estarÃ¡ activo desde el <b>lunes 20 de octubre de 2025 a las 9:00 a.m.</b> hasta el <b>viernes 24 de octubre de 2025 a las 5:00 p.m.</b> Cada colaborador puede jugar una sola vez dentro de este perÃ­odo.</p>
          <hr style="margin: 10px 0;">
          <p><b>ğŸ‘¥ ParticipaciÃ³n:</b> Abierta a todos los colaboradores de la empresa. Cada jugador representarÃ¡ el Ã¡rea al que pertenece formalmente.</p>
          <p><b>ğŸ§© DinÃ¡mica del Juego:</b> El juego consta de dos niveles con preguntas y desafÃ­os sobre reciclaje. Las preguntas se mostrarÃ¡n en orden aleatorio para cada participante. Incluye temas sobre <b>la segregaciÃ³n</b> de residuos.</p>
          <p><b>ğŸ… Puntaje:</b> Cada respuesta correcta equivale a <b>1 punto</b>. En la segunda etapa, se restarÃ¡n <b>0.35 puntos</b> por cada error, ademÃ¡s de que la imagen serÃ¡ cambiada por otra opciÃ³n.</p>
          <p><b>â±ï¸ Cronometraje:</b> El cronÃ³metro inicia automÃ¡ticamente al comenzar el juego y se detiene al completar el Ãºltimo nivel. No se puede pausar.</p>
          <p><b>ğŸ“Š Sistema de PuntuaciÃ³n por Ãrea:</b> El puntaje final de cada Ã¡rea serÃ¡ el <b>promedio</b> de los puntajes individuales obtenidos por sus miembros, garantizando una competencia equitativa.</p>
          <p><b>âš–ï¸ Criterio de Desempate:</b> En caso de empate, ganarÃ¡ el Ã¡rea con el menor tiempo promedio de completado.</p>
          <p><b>ğŸ› ï¸ Juego Limpio y Soporte TÃ©cnico:</b>Se apela a la honestidad y al espÃ­ritu de aprendizaje individual. Si enfrentas un problema tÃ©cnico que interrumpe tu juego (ej: la pÃ¡gina se congela), no te preocupes. Reporta el incidente con una captura de pantalla al nÃºmero <b>959 738 482</b> para recibir asistencia y poder reiniciar tu participaciÃ³n.</p>
          <p><b>ğŸ† Anuncio de Ganadores y Reconocimiento:</b> Los resultados se anunciarÃ¡n el <b>lunes 27 de octubre</b>. El Ã¡rea ganadora recibirÃ¡ un reconocimiento especial. TambiÃ©n se mencionarÃ¡ a los <b>3 mejores puntajes individuales</b> de toda la empresa.</p>
          <hr style="margin: 10px 0;">
          <p><b>Â¡Mucha suerte a todos y que gane el Ã¡rea con la mejor cultura de segregaciÃ³n y reciclaje!</b></p>
        </div>`,
        confirmButtonText: 'Â¡Entendido!',
        confirmButtonColor: '#16a34a',
        allowOutsideClick: false,
        width: 800,
        customClass: {
          confirmButton: 'custom-confirm-button',
          popup: 'custom-popup'
        }
        });
        const style = document.createElement('style');
      style.innerHTML = `
        .custom-popup {
          display: flex !important;
          flex-direction: column;
          align-items: center;
        }
        .custom-confirm-button {
          font-weight: bold !important;
          padding: 16px 30px !important;
          border-radius: 12px !important;
        }
      `;
      document.head.appendChild(style);
    });
  </script>
</body>
</html>

